<?php $n=get_declared_classes();require'c.inc';$s=$_SERVER;$m=$s['REQUEST_METHOD'];$uri=@$s['PATH_INFO']?$s['PATH_INFO']:'/';foreach(array_diff(get_declared_classes(),$n)as$c){if(preg_match(sprintf('!^%s$!',constant("{$c}::URI")),$uri)){if(!method_exists($c,$m))continue;$c=new $c;$c->req=new Req;$c->req->method=$m;return$c->$m()->send();}}class Req{function __call($m,$args){switch ($m){case'param':$param=$GLOBALS['_'.$this->method];break;default:$param=@$GLOBALS['_'.strtoupper($m)];}return @$param[$args[0]]?$param[$args[0]]:@$args[1];}}class Res{function send(){foreach((array)$this->header as$h)header($h);foreach((array)$this->cookie as$c)call_user_func_array('setrawcookie',$c);echo $this->content;}}
